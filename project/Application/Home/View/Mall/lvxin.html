<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
	<link rel="stylesheet" href="__PUBLIC__/Home/css/resetstyle.css">
	<script src="__PUBLIC__/Home/js/jquery-1.8.3.min.js"></script>
	<script src="__PUBLIC__/Home/js/public.js"></script>
	<title>滤芯</title>
	<style>
		* {
            margin: 0;
            padding: 0;
            -webkit-box-sizing: border-box;
                    box-sizing: border-box;
        }
        body {
            overflow-x: hidden;
            font-size: 0.7rem;
            color:#373737;
        }
        #content {
            width: 300vw;
            height: 84vh;
            position: relative;
            margin-top: 8vh;
            left: -200vw;
            margin-bottom: 8vh;
            background: #f3f3f3;
            overflow: scroll;
        }
        #header, #footer {
            width: 100vw;
            height: 8vh;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -ms-flex-pack: distribute;
                justify-content: space-around;
            -webkit-box-align: center;
                -ms-flex-align: center;
                    align-items: center;
            position: fixed;
            font-size: .8rem;
            background: #fff;
            z-index: 999;
        }
        #header {
            top: 0;
            left: 0;
            border-bottom: 1vh solid #ddd;
        }
        #header>span {
            width: 33.33%;
            height: 8vh;
            line-height: 8vh;
            text-align: center;
            vertical-align: middle;
        }
        /*滤芯详情，滤芯复位，滤芯购买*/
        #lvxinDetail,
        #lvxinReset,
        #lvxinBuy {
            width: 100vw;
            /*height: 84vh;*/
            display: inline-block;
            position: absolute;
            top: 0;
            background: #fff;
        }
        #lvxinReset {
            left: 100vw;
         }
        #lvxinBuy{
            left: 200vw;
        }
        /*顶栏下划线，移动位置改这里*/
        #line {
            width: 33.33vw;
            height: 1vh;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-pack: center;
                -ms-flex-pack: center;
                    justify-content: center;
            position: absolute;
            left: 0;
            bottom: 0vh;
            margin-bottom: -1vh;
            margin-left: 66.66%;
            text-align: center;
            -webkit-transition: .2s ease;
            transition: .2s ease;
        }
        #line>span {
            width: 50%;
            height: 100%;
            display: block;
            position: relative;
            top: 0;
            border-radius: 20px;
            background: #76BAF3;
        }
		/*
			滤芯开始
		*/
        #ulDiv {
        	height: 10vh;
        	position: fixed;
            top: 0;
        	background: #fff;
        	z-index: 999;
        }
        #lvxinDetailUL>._padding,
        #lvxinReset>._padding {
            margin-bottom: 3vh;
        }
        #ulDiv>ul>li {
            height: 9vh;
            line-height: 9vh;
            vertical-align: middle;
            font-size: .5rem;
        }
        ._ul li:nth-of-type(1) {
            color: #039CE9;
            font-weight: normal;
        }
        
        ._ul li:nth-of-type(2) {
            color: #6F6F6F;
            font-weight: normal;
        }
        ._btn {
            background: #039CE9;
        }
		._padding{
		    padding: 10px 10px 0 10px;
		    position: relative;
		}
		._padding>p {
			margin: 1vh 0;
		}
		._progress{
		    height: 4px;
		    display: flex;
		    align-items: center;
		    margin: 3vh auto;
		    border-radius: 10px;
		    background: #dfdfdf;
		    overflow: visible;
		}
		.progress-bar {
		    height: 12px;
		    border-radius: 6px;
		    background: #039CE9;
		    background-size: 10px 10px;
		    background-image: linear-gradient(-45deg, rgba(255, 255, 255, .2) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, .2) 50%, rgba(255, 255, 255, .2) 75%, transparent 75%, transparent);
		    background-image: -webkit-linear-gradient(-45deg, rgba(255, 255, 255, .2) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, .2) 50%, rgba(255, 255, 255, .2) 75%, transparent 75%, transparent);
		    background-image: -o-linear-gradient(-45deg, rgba(255, 255, 255, .2) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, .2) 50%, rgba(255, 255, 255, .2) 75%, transparent 75%, transparent);
		}
		#lvxinIntroduce {
	        padding: 0;
	        margin: 2vh 0;
	    }
	    #lvxinIntroduce>div {
	        padding: 2vh 1vh;
	        border-bottom: 1px solid #ccc;
	    }
	    #lvxinIntroduce>div:nth-of-type(1) {
	        border-top: 1px solid #ccc;
	    }
	    #lvxinDetailUL .checkbox {
	        display: none;
	    }
		#lvxinReset p{
			padding-left:10vw; 
		}
	    .progress {
	        position: relative;
	        margin-left: 10vw;
	    }
	    .progress>.checkbox {
	        width: 6vw;
	        height: 6vw;   
	        display: flex;
	        justify-content: center;
	        align-items: center;
	        position: absolute;
	        top: -4vw;
	        left: 0;
	        margin-left: -6vh;
	        right: 15px;
	        border: 1px solid #7D7FCE;
	        border-radius: 50%;
	    }
	    .progress>.checkbox>span {
	        width: 4vw;
	        height:4vw;
	        display: block;
	        position: absolute;
			left:3px;
			top:3px;
	        border: none;
	        outline: none;
	        border-radius: 2.2vh;
	        background: #039CE9;;
	        visibility: hidden;
	    }
	    .progress>.checkbox>input[type="checkbox"]:checked {
	        background: #7D7FCE;
	    }
		/****** 滤芯结束 *******/
        /*商品*/
        .goods {
            width: 94vw;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            position: relative;
            padding: 3% 0;
            left: 50%;
            margin-left: -47%;
            border-bottom: 1px solid #eee;
            font-size: .6rem;
        }

        /*商品图片*/
        .goods>.img {
            width: 36%;
            margin: 2% 2% 2% 0;
            border: 1px solid #ddd;
            border-radius: 10px;
        }   
        .goods>.img>img {
            width: 100%;
            height: ;
            display: inline-block;
        }
        /*商品描述*/
        .goods>.desc {
            width: 64%;
            padding: 2% 0 2% 2%;
            background: #fff;
        }
        .goods>.desc>h5{
        	font-size: 0.72rem;
			font-weight: 500;
			color: #5a5a5a;
        }
        /*价格和数量*/
        .desc>div {
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-pack: justify;
            -ms-flex-pack: justify;
            justify-content: space-between;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
           
        }
        .goods>.desc>p {
            font-size: .5rem;
            margin: 4% 0;
            color: #5a5a5a;
			font-size: 0.65rem;


        }

        /*商品数量*/
        .num {
            width: 35%;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-pack: center;
                -ms-flex-pack: center;
                    justify-content: center;
            -webkit-box-align: stretch;
                -ms-flex-align: stretch;
                    align-items: stretch;
        }

        /*商品价格*/
        .price {
            color:#fc2a2b;
            font-size: .72rem;
        }
        .num>input {
            width: 33%;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-pack: center;
                -ms-flex-pack: center;
                    justify-content: center;
            -webkit-box-align: center;
                -ms-flex-align: center;
                    align-items: center;
            text-align: center;
            font-size: 1rem;
            border: none;
            -webkit-appearance: none;
            border-radius: 4px;
        }
        .num>.number {
            width: 33%;
            margin: 0 4px;
            text-align: center;
            border-radius: 4px;
            border: 1px solid #a4a4a4;
            font-size: .8rem;
        }
        #footer {
            bottom: 0;
            left: 0;
            border-top: 1px solid #e0e0e0;
        }
        #footer>div, #footer>span {
            height: 8vh;    
            display: inline-block;
            line-height: 8vh;
            text-align: center;
            vertical-align: middle;
        }
        #footer>div {
            width: 60%;
        }
        #footer>div>span {
            color: #FC3132;
        }
        #footer>span {
            width: 40%;
            color: #fff;
            background: #2EB6AA;
        }
	</style>
</head>
<body>
	<header id="header">
		<span class="tabTitle" index="0">滤芯详情</span>
		<span class="tabTitle" index="1">滤芯复位</span>
		<span class="tabTitle" index="2">滤芯购买</span>
		<div id="line"><span></span></div>
	</header>
	<div id="content">
		<!-- 滤芯详情 -->
		<div id="lvxinDetail">
	        <div class="_background_color">
	            <!-- progress -->
	            <div>
	                <ul id="lvxinDetailUL"></ul>
	            </div>            
	            <!-- RO膜 -->
	            <div class="_padding" id="lvxinIntroduce">
	            </div>
	        </div>
		</div>
		<!-- 滤芯复位 -->
		<div id="lvxinReset">
	        <div class="_background_color _displey">
	            <!-- progress -->
				<ul id="lvxinReset">
				</ul>
	            <div class="_text_align">
	                <button class="_btn">立即复位</button>
	            </div>
	        </div>
		</div>
		<!-- 滤芯购买 -->
		<div id="lvxinBuy">
			<div class="goods">
				<div class="img"><img src="1.jpg" alt="正在加载..."></div>
				<div class="desc">
					<h5>RO膜</h5>
					<p>RO膜能够有效地去除水中钙、镁、 细菌、有机物、无机物、金属离子和 放射性物质等</p>
					<div>
						<span class="price">￥<span>120.00</span></span>
						<span class="num">
							<input type="button" value="-" class="minus">
							<input class="number" type="number" value="0">
							<input type="button" value="+" class="plus">
						</span>
					</div>
					
				</div>
			</div>
			<div class="goods">
				<div class="img"><img src="2.jpg" alt="正在加载..."></div>
				<div class="desc">
					<h5>RO膜</h5>
					<p>RO膜能够有效地去除水中钙、镁、 细菌、有机物、无机物、金属离子和 放射性物质等</p>
					<div>
						<span class="price">￥<span>120.00</span></span>
						<span class="num">
							<input type="button" value="-" class="minus">
							<input class="number" type="number" value="0" min="0" max="9">
							<input type="button" value="+" class="plus">
						</span>
					</div>
					
				</div>
			</div>
			<div class="goods">
				<div class="img"><img src="3.jpg" alt="正在加载..."></div>
				<div class="desc">
					<h5>RO膜</h5>
					<p>RO膜能够有效地去除水中钙、镁、 细菌、有机物、无机物、金属离子和 放射性物质等</p>
					<div>
						<span class="price">￥ <span>120.00</span></span>
						<span class="num">
							<input type="button" value="-" class="minus">
							<input class="number" type="number" value="0" min="0" max="9">
							<input type="button" value="+" class="plus">
						</span>
					</div>
					
				</div>
			</div>
			<div class="goods">
				<div class="img"><img src="1.jpg" alt="正在加载..."></div>
				<div class="desc">
					<h5>RO膜</h5>
					<p>RO膜能够有效地去除水中钙、镁、 细菌、有机物、无机物、金属离子和 放射性物质等</p>
					<div>
						<span class="price">￥<span>120.00</span></span>
						<span class="num">
							<input type="button" value="-" class="minus">
							<input class="number" type="number" value="0" min="0" max="9">
							<input type="button" value="+" class="plus">
						</span>
					</div>
					
				</div>
			</div>
			<div class="goods">
				<div class="img"><img src="1.jpg" alt="正在加载..."></div>
				<div class="desc">
					<h5>RO膜</h5>
					<p>RO膜能够有效地去除水中钙、镁、 细菌、有机物、无机物、金属离子和 放射性物质等</p>
					<div>
						<span class="price">￥<span>120.00</span></span>
						<span class="num">
							<input type="button" value="-" class="minus">
							<input class="number" type="number" value="0" min="0" max="9">
							<input type="button" value="+" class="plus">
						</span>
					</div>
					
				</div>
			</div>

			<footer id="footer">
				<div>合计：<span>￥0</span></div>
				<span id="pay">去结算</span>
			</footer>
		</div>
	</div>
	<script>
	$(function(){
		var filtermode = 1;
		var moHTML = '',lvxinIntroduceHTML='';
		var data = [
			{redayfilter: '1'}
		]
		var res = [
			{filtername:'啊1',timelife: 20,introduce: '是否合适肯定会诉求'},
			{filtername:'啊2',timelife: 10,introduce: '是否合适肯定会诉求'},
			{filtername:'啊3',timelife: 40,introduce: '是否合适肯定会诉求'},
			{filtername:'啊4',timelife: 80,introduce: '是否合适肯定会诉求'},
			{filtername:'啊5',timelife: 50,introduce: '是否合适肯定会诉求'},
			{filtername:'啊6',timelife: 60,introduce: '是否合适肯定会诉求'}
		];
		for(var i=0; i<res.length; i++){
		    //alert(data.filtermode);
		    if(filtermode =="0"){
				//按时间
		        // 遍历膜的详情, 不存在则不遍历
		        if(res[i].filtername){

		            moHTML += '<li class="_padding">'+
		                '<p><span class="">'+ res[i].filtername +
		                '</span><span class="_float_right">'+
		                ((data['redayfilter'+(i+1)]/res[i].timelife)*100).toFixed(0)
		                +'%</span></p>'+
		                '<p class="_text_align">'+
		                    '<div class="progress _progress _width">'+
		                       '<div class="checkbox"><span class="chBox" name='+ 'filter'+i +'></span></div>'+
		                      '<div class="progress-bar progress-bar-striped" role="progressbar" style="width:'+
		                     ((data['redayfilter'+(i+1)]/res[i].timelife)*100).toFixed(0) +
		                      '%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>'+
		                    '</div>'+
		                '</p>'+
		            '</li>';
		        }

		        //滤芯简介
		        if(res[i].introduce){

		            res[i].timelife = !res[i].timelife ? 0 : res[i].timelife;
		            data['redayfilter'+(i+1)] = !data['redayfilter'+(i+1)] ? 0 : data['redayfilter'+(i+1)];

		            lvxinIntroduceHTML += '<div>'+
		                '<h3>'+
		                    res[i].filtername +
		                '</h3>'+
		                '<p>'+
		                    res[i].introduce +
		                '</p>'+
		                '<p>'+
		                    '<span class="_font_weigth">总寿命：'+ res[i].timelife +
		                    '天</span>'+
		                    '<span class="_float_right _font_weigth">剩余：'+ data['redayfilter'+(i+1)] +
		                    '天</span>'+
		                '</p>'+
		            '</div>';
		        }
		    }else if(filtermode == "1"){
		        //流量模式
		         // 遍历滤芯详情, 不存在则不遍历
		        if(res[i].filtername){

		            moHTML += '<li class="_padding">'+
		                '<p><span class="">'+ res[i].filtername +
		                '</span><span class="_float_right">'+
		                ((data['reflowfilter'+(i+1)]/res[i].flowlife)*100).toFixed(0)
		                +'%</span></p>'+
		                '<p class="_text_align">'+
		                    '<div class="progress _progress _width">'+
		                       '<div class="checkbox"><span class="chBox" name='+ 'filter'+i +'></span></div>'+
		                      '<div class="progress-bar progress-bar-striped" role="progressbar" style="width:'+
		                     ((data['reflowfilter'+(i+1)]/res[i].flowlife)*100).toFixed(0) +
		                      '%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>'+
		                    '</div>'+
		                '</p>'+
		            '</li>';
		        }

		        //滤芯简介
		        if(res[i].introduce && data.reflowfilter+[i+1]){
		            res[i].flowlife = !res[i].flowlife ? 0 : res[i].flowlife;
		            data['reflowfilter'+(i+1)] = !data['reflowfilter'+(i+1)] ? 0 : data['reflowfilter'+(i+1)];

		            lvxinIntroduceHTML += '<div>'+
		                '<h3>'+
		                    res[i].filtername +
		                '</h3>'+
		                '<p>'+
		                    res[i].introduce +
		                '</p>'+
		                '<p>'+
		                    '<span class="_font_weigth">总寿命：'+ res[i].flowlife +
		                    'L</span>'+
		                    '<span class="_float_right _font_weigth">剩余：'+ data['reflowfilter'+(i+1)] +
		                    'L</span>'+
		                '</p>'+
		            '</div>';
		        }
		    }else if(filtermode == "2"){
		        //按流量和时间
		        // 遍历膜的详情, 不存在则不遍历

		       if( ((data['reflowfilter'+(i+1)]/res[i].flowlife)*100).toFixed(0) >
		        ((data['redayfilter'+(i+1)]/res[i].timelife)*100).toFixed(0) ){
		            //时间剩余比例小则显示时间
		            if(res[i].filtername){

		                moHTML += '<li class="_padding">'+
		                    '<p><span class="">'+ res[i].filtername +
		                    '</span><span class="_float_right">'+
		                    ((data['redayfilter'+(i+1)]/res[i].timelife)*100).toFixed(0)
		                    +'%</span></p>'+
		                    '<p class="_text_align">'+
		                        '<div class="progress _progress _width">'+
		                           '<div class="checkbox"><span class="chBox" name='+ 'filter'+i +'></span></div>'+
		                          '<div class="progress-bar progress-bar-striped" role="progressbar" style="width:'+
		                         ((data['redayfilter'+(i+1)]/res[i].timelife)*100).toFixed(0) +
		                          '%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>'+
		                        '</div>'+
		                    '</p>'+
		                '</li>';
		            }

		            //滤芯简介
		            if(res[i].introduce){
		                res[i].timelife = !res[i].timelife ? 0 : res[i].timelife;
		                res[i]['redayfilter'+(i+1)] = !res[i]['redayfilter'+(i+1)] ? 0 : res[i]['redayfilter'+(i+1)];

		                lvxinIntroduceHTML += '<div>'+
		                    '<h3>'+
		                        res[i].filtername +
		                    '</h3>'+
		                    '<p>'+
		                        res[i].introduce +
		                    '</p>'+
		                    '<p>'+
		                        '<span class="_font_weigth">总寿命：'+ res[i].timelife +
		                        '</span>'+
		                        '天<span class="_float_right _font_weigth">剩余：'+ res[i]['redayfilter'+(i+1)] +
		                        '天</span>'+
		                    '</p>'+
		                '</div>';
		            }
		        }else{
		            //流量剩余比例小则显示流量
		            if(res[i].filtername){

		                moHTML += '<li class="_padding">'+
		                    '<p><span class="">'+ res[i].filtername +
		                    '</span><span class="_float_right">'+
		                   ((data['reflowfilter'+(i+1)]/res[i].flowlife)*100).toFixed(0)
		                    +'%</span></p>'+
		                    '<p class="_text_align">'+
		                        '<div class="progress _progress _width">'+
		                           '<div class="checkbox"><span class="chBox" name='+ 'filter'+i +'></span></div>'+
		                          '<div class="progress-bar progress-bar-striped" role="progressbar" style="width:'+
		                         ((data['reflowfilter'+(i+1)]/res[i].flowlife)*100).toFixed(0) +
		                          '%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>'+
		                        '</div>'+
		                    '</p>'+
		                '</li>';
		            }

		            //滤芯简介
		            if(res[i].introduce){
		                res[i].flowlife = !res[i].flowlife ? 0 : res[i].flowlife;
		                res[i].balancaflow = !res[i].balancaflow ? 0 : res[i].balancaflow;

		                lvxinIntroduceHTML += '<div>'+
		                    '<h3>'+
		                        res[i].filtername +
		                    '</h3>'+
		                    '<p>'+
		                        res[i].introduce +
		                    '</p>'+
		                    '<p>'+
		                        '<span class="_font_weigth">总寿命：'+ res[i].flowlife +
		                        '</span>'+
		                        'L<span class="_float_right _font_weigth">剩余：'+ res[i].balancaflow +
		                        'L</span>'+
		                    '</p>'+
		                '</div>';
		            }
		        }
		    }else{
		        // 没有数据时的显示状态
		        if(((data['reflowfilter'+(i+1)]/res[i].flowlife)*100).toFixed(0) >
		        ((data['redayfilter'+(i+1)]/res[i].timelife)*100).toFixed(0) ){
		            //时间比例小则按时间显示
		            moHTML += '<li class="_padding">'+
		                '<p><span class="">'+ res[i].filtername +
		                    '</span><span class="_float_right">0%</span></p>'+
		                '<p class="_text_align">'+
		                    '<div class="progress _progress _width">'+
		                       '<div class="checkbox"><span class="chBox" name="0"></span></div>'+
		                      '<div class="progress-bar progress-bar-striped" role="progressbar" style="width:0%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>'+
		                    '</div>'+
		                '</p>'+
		            '</li>';

		            //滤芯简介
		            res[i].timelife = !res[i].timelife ? 0 : res[i].timelife;
		            data['redayfilter'+(i+1)] = !data['redayfilter'+(i+1)] ? 0 : data['redayfilter'+(i+1)];
		            lvxinIntroduceHTML += '<div>'+
		                '<h3>'+
		                    res[i].filtername +
		                '</h3>'+
		                '<p>'+
		                    res[i].introduce +
		                '</p>'+
		                '<p>'+
		                    '<span class="_font_weigth">总寿命：'+ res[i].timelife +
		                    '天</span>'+
		                    '<span class="_float_right _font_weigth">剩余：'+ data['redayfilter'+(i+1)] +
		                    '天</span>'+
		                '</p>'+
		            '</div>';

		        }else{
		             //流量比例小则按流量显示
		             moHTML += '<li class="_padding">'+
		                '<p><span class="">'+ res[i].filtername +
		                    '</span><span class="_float_right">0%</span></p>'+
		                '<p class="_text_align">'+
		                    '<div class="progress _progress _width">'+
		                       '<div class="checkbox"><span class="chBox" name="0"></span></div>'+
		                      '<div class="progress-bar progress-bar-striped" role="progressbar" style="width:0%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>'+
		                    '</div>'+
		                '</p>'+
		            '</li>';

		            //滤芯简介
		            res[i].flowlife = !res[i].flowlife ? 0 : res[i].flowlife;
		            data['reflowfilter'+(i+1)] = !data['reflowfilter'+(i+1)] ? 0 : data['reflowfilter'+(i+1)];
		            lvxinIntroduceHTML += '<div>'+
		                '<h3>'+
		                    res[i].filtername +
		                '</h3>'+
		                '<p>'+
		                    res[i].introduce +
		                '</p>'+
		                '<p>'+
		                    '<span class="_font_weigth">总寿命：'+ res[i].flowlife +
		                    'L</span>'+
		                    '<span class="_float_right _font_weigth">剩余：'+ data['reflowfilter'+(i+1)] +
		                    'L</span>'+
		                '</p>'+
		            '</div>';
		        }
		    }

		}
		$("#lvxinDetailUL").html(moHTML);
		$("#lvxinIntroduce").html(lvxinIntroduceHTML)
		var lvxinArr = ['#lvxinDetail', '#lvxinReset' ,'#lvxinBuy'];
		var priceAll = 0;	//合计价格
		// 点击顶部tab切换内容
		$(".tabTitle").click(function(){

			// 判断内容是否超出
			if($("#content>div").length != 0){

				$("#content")
				.css({height: lvxinArr[$(this).attr("index")]
					.height, 
					overflowY: $(lvxinArr[$(this).attr("index")])[0].offsetHeight > $("#content")[0].offsetHeight 
					? 'visible'
					: 'hidden'
				});
			}
			// 横线移动
			$("#line").css({marginLeft: $(this).attr("index")*33.33 + '%'});

			// 内容切换
			$("#content").animate({left: '-'+$(this).attr("index") + '00vw'})
			
		})
		// 按加'+'号
		$("#lvxinBuy").on("touchend",".plus",function(){
			priceAll = 0;	//合计归零，后面重新计算
			// 获取数量
			var value = $(".number").val();
			$(this).siblings(".number")[0].value++;

			// 实时将总价格更新到合计
			for(var i=0; i<$(".goods").length; i++){
				if($(".goods").eq(i).find(".number")[0].value != 0){

					priceAll += parseFloat($(".goods").eq(i).find(".number")[0].value)*parseFloat($(".goods").eq(i).find(".price>span").text());
				}
			}
			// console.log(priceAll)
			$("#footer>div>span").text('￥'+priceAll)
		});

		//按减'-'号
		$("#lvxinBuy").on("touchend",".minus",function(){
			priceAll = 0;	//合计归零，后面重新计算
			// 获取数量
			var value = $(".number").val();
			for(var i=0; i<$(this).siblings(".number").length; i++){
				$(this).siblings(".number").val() <= 0
				? 0
				: $(this).siblings(".number")[i].value--
			}
			// console.log($(this).siblings(".number")[0].value);

			// 实时将总价格更新到合计
			for(var i=0; i<$(".goods").length; i++){
				if($(".goods").eq(i).find(".number")[0].value != 0){

					priceAll += parseFloat($(".goods").eq(i).find(".number")[0].value)*parseFloat($(".goods").eq(i).find(".price>span").text());
				}
			}
			// console.log(priceAll)
			priceAll = priceAll < 0 ? 0 : priceAll;
			$("#footer>div>span").text('￥'+priceAll)
		});
		/*
			filtername: 滤芯名称
			picturepath：图片路径
			desc：滤芯描述
			price：滤芯价格
			num：选择的数量
			priceAll：合计价格
		 */
		// 存储数量超过1的滤芯产品
		var goodsArr = [];
		var goods = $(".goods");
		// 点击‘去结算’
		$("#pay").click(function(){
			for(var i=0; i<goods.length;i++){
				if(goods.eq(i).find(".number").val() != 0){
					//这个priceAll是单一商品的价格合计
					var priceAll = parseInt(goods.eq(i).find(".price span").text())*parseInt(goods.eq(i).find(".number").val())
					goodsArr.push(
						{'filtername': goods.eq(i).find("h5").text(),
						'picturepath': goods.eq(i).find(".img img").attr("src"),
						'desc': goods.eq(i).find(".desc>p").text(),
						'price': parseInt(goods.eq(i).find(".price span").text()),
						'num': parseInt(goods.eq(i).find(".number").val()),
						'priceAll': priceAll
						}
					)
				}
			}
			var goodsData = JSON.stringify(goodsArr);
			sessionStorage.setItem('goodsData',goodsData);
			// console.log(goodsData);
			// 选择滤芯后跳转
			if(goodsArr.length){
				// 跳到订单确认界面
				location.href = '{{:U("PaymentSystem/payConfirm")}}';
				// // ajax提交数据到订单界面
				// $.ajax({
				// 	url: '{{:U("PaymentSystem/payConfirm")}}',
				// 	type: 'post',
				// 	datatype: 'json',
				// 	data: goodsData,
				// 	success: function(res){
				// 		console.log(res);
				// 		// 跳到订单确认界面
				// 		location.href = '{{:U("PaymentSystem/payConfirm")}}';
				// 	},
				// 	error: function(res){}
				// })
			}else{
				alert('请先选择需要购买的商品！')
			}
			
		})
	})
	</script>
</body>
</html>