<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
	<link rel="stylesheet" href="__PUBLIC__/Home/css/resetstyle.css">
	<link rel="stylesheet" href="__PUBLIC__/Home/fonts/iconfont.css">

	<script src="__PUBLIC__/Home/js/public.js"></script>
	<script src="__PUBLIC__/Home/js/jquery-1.8.3.min.js"></script>
	<title>订单确认</title>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}
		body {
			font-size: .7rem;
			overflow-x: hidden;
			color:#373737;
		}
		#content {
			width: 100vw;
			height: 100vh;
			min-height: 100vh;
			overflow-x: hidden;
			overflow-y: scroll;
			background: #f1f1f1;
		}
		#header {
			width: 100vw;
			display: flex;
			position: relative;
			font-size: .7rem;    
			padding: 5% 4%;
			background: #fff;
		}
		#hLeft {
			width: 79vw;
			display: inline-block;
			letter-spacing: 1px;
		}
		#hRight {
			width: 20vw;
			display: inline-block;
			text-align: center;
    		align-self: center;    
    		font-size: 1rem;
    		/*margin-top: -1.4rem;*/
		}
		#header>div>p {
			width: 100%;
			display: inline-block;
			position: relative;
			margin: 2% 0;
			font-size: 0.68rem;
		}
		#header>div>p>span:nth-of-type(1) {
			float: left;
			line-height: 1.2rem;
		}
		#header>div>p>span:nth-of-type(2) {
			float: right;
			line-height: 1.2rem;
		}
		#header>div>p>span:after {
			content: '';
			clear: both;
		}
		#main {
			width: 100vw;
			/*height: 83vh;*/
			position: relative;
			left: 0;
			border-top: 1vh solid #f1f1f1;
			background: #fff;
		}
		/*订单ID*/
		.dingdanID {
			padding: 1% 4%;
		}
		.goods {
			width: 94vw;
			display: flex;
			position: relative;
			padding: 3% 0;
			left: 50%;
			margin-left: -47%;
			border-bottom: 1px solid #eee;
			font-size: .6rem;
		}

		.goods>.img {
			width: 36%;
			margin: 2% 2% 2% 0;
			border: 1px solid #ddd;
			border-radius: 10px;
		}	
		.goods>.img>img {
			width: 100%;
			height: ;
			display: inline-block;
		}
		.goods>.dec {
			width: 64%;
			padding: 2% 0 2% 2%;
			background: #fff;
		}
		.goods>.dec>p {
			font-size: .5rem;
			margin: 4% 0;
			color: #555;
		}
		.num {
			width: 26%;
			float: right;
			white-space: nowrap;
		}
		.num:after {
			content: '';
			clear: both;
		}
		.price {
			color: #FC3132;
			font-size: .7rem;
		}
		.num>b, .num>input {
			width: 33%;
			text-align: center;
		}
		#calc {
		    color: #333;
			border-bottom: 1px solid #eee;
			background: #fff;
		}
		.ynticket{
			padding: 4% 3% 5%;
			/*height: 1.6rem;*/
			line-height: 1.6rem;
			width: 100%;
			background: #fff;
			margin-bottom: 8vh;
		}
		.ynticke>b{
			display: inline-block;
			float: left;
		}
		.ynticket>a{
			width: 50%;
			display: inline-block;
			font-size: 0.6rem;
			float: right;
			text-align: right;
		}
		.ynticket>a>i{
			font-size:0.6rem; 
		}
		#calc>p {
		    padding: 4% 3%;
		    font-size: .7rem;
		    text-align: right;
		}
		#calc>p>b{
			color: #5a5a5a;
		}
		#payWay {
			width: 100vw;
			height: 100vh;
			min-height: 100vh;
			display: none;
			position: fixed;
			left: 0;
			bottom: -100vh;
			z-index: 999;
		}
		#payWay>div {
			position: relative;
			background: #fff;
		}
		#payMask {
			width: 100%;
			height: 30vh;
			background: rgba(0,0,0, 0) !important;
		}
		#choosePay {
			height: 54vh;
		}
		#choosePay>div:not(:nth-of-type(1)) {
			padding: 0 5%;
		}
		#payTitle {
			position: relative;
		    display: flex;
		    justify-content: center;
		    align-items: center;
		    margin-bottom: 10px;
			border-bottom: 1px solid #eee;
		}
		#closePay {
			width: 14vmin;
			height: 14vmin;
			position: absolute;
			left: 0;
			border-radius: 14vmin;
			line-height: 14vmin;
			text-align: center;
			font-size: .9rem;
		}
		#closePay:active {
			background: #ddd;
		}
		#payTitle>p:nth-of-type(2) {
			width: 100vw;
			height: 8vh;
		    display: flex;
		    justify-content: center;
		    align-items: center;
		    flex-flow: column;
		    padding: 2% 0;
		    line-height: 32px;
		    font-size: .8rem;
    		font-weight: 600;
			background: #fff;
		}
		#localPay {
			border-bottom: 8px solid #eee;
		}
		#localPay>p, 
		#othersPay>p {
			padding: 3.8vw 0;
			border-bottom: 1px solid #eee;
		}
		#localPay>p>label, 
		#othersPay>p>label {
			width: 84vw;
			display: inline-block;
		}

		#localPay>p>input, 
		#othersPay>p>input {
			width: 6vw;
    		height: 6vw;
			position: relative;
			float: right;
			border-radius: 3px;
			border: 1px solid #bdbdbd;
			background: #fff;
			appearance: none;
			-webkit-appearance: none;
		}

		#localPay>p>input:after, 
		#othersPay>p>input:after {
			content: '';
			clear: both;
		}
		#localPay>p>input:checked, 
		#othersPay>p>input:checked {
			border: none;
			background: url('__PUBLIC__/Home/images/check.png') #56AAF1 no-repeat;
			background-size: 76%;
			background-position: center;
		}
		#payNow {
			width: 100vw;
			height: 16vh;
			display: flex;
			justify-content: center;
			align-items: center;
			border-top: 1px solid #eee;
			background: #f3f3f3 !important;
		}
		#payNow>div {
			width: 80%;
			padding: 2% 0;
			text-align: center;
			font-weight: 600;
			color: #fff;
			border-radius: 5px;
			background: #2EB6AA;
		}
		#footerContain {
			width: 100vw;
			height: 8vh;
			display: flex;
			justify-content: space-around;
			align-items: center;
			position: fixed;
			bottom: 0;
			left: 0;
			border-top: 1px solid #e0e0e0;
			font-size: .8rem;
			background: #fff;
		}

		#footerContain>div, 
		#footerContain>span {
			height: 8vh;    
			display: inline-block;
		    line-height: 8vh;
    		text-align: center;
		    vertical-align: middle;
		}
		#footerContain>div {
			width: 60%;
		}
		#footerContain>div>span {
			color: #FC3132;
		}
		#footerContain>span {
			width: 40%;
			color: #fff;
			background: #2EB6AA;
		}
		/*付款页面*/
		.paystyle{
			position:absolute;
			top:0;
			left: 0;
			width: 100vw;
			height: 100vh;
			display: none;
		}
		.paystyleTop{
			width: 100vw;
			height: 10vh;
			background: #000;
			opacity: 0.3;
		}
		.payContain{
			position: absolute;
			bottom: 0;
			height: 90vh;
			width: 100vw;
			/*opacity: 0.5;*/
			z-index: 999;
			background: #FFF;
		}
		.payContain>.paytop{
			padding:0.5rem;
    		border-bottom: 1px solid #E5E5E5;
		}
		.paytop>.paytopLeft>i{
			float: left;
    		padding: 0.6rem 0;
    		margin-right: 4rem;
    		font-size: 1.5rem;
		}
		/*支付图标的颜色*/
		.icon-jinbi{
			color:#FEDA02;
		}
		.icon-yingbi{
			color:#97C3C0;
			
		}
		.icon-z-weixin{
			color:#149E23;
			
		}
		.icon-zhifubao{
			color:#22A8FF;
			
		}
		.icon-yinhang-yinlian-{
			color:#6BB5BB;
			
		}
		.paytop>.paytopRight{
			float: left;
    		text-align: center;
		}
		.icon-kuang1{
			color:#ccc;
		}
		.paytop>.paytopRight>h3{
			font-size: 0.9rem;
    		font-weight: 600;
    		padding: 0 0 0.5rem;
		}
		.paytop>.paytopRight>p{
			font-size: 0.9rem;
			font-weight: 600;
		}
		.paymidd>h3{
			padding:0.8rem;
		}
		.paymidd>ul>li{
			padding:0.5rem 0.5rem;
			border-bottom: 1px  solid #E5E5E5;
		}
		.paymidd>ul>li:nth-child(2){
			border-bottom: 6px  solid #E5E5E5;
			
		}
		.paymidd>ul>li>i{
			padding-right:0.4rem; 
			font-size: 1.2rem;
		}
		.paymidd>ul>li>span{
			float: right;
			font-size: 1rem;
		}
		.paymidd>ul>li>span.icon-xuanze{
			color: #4280EC;

		}
		/*底部按钮*/
		.payBott{
			width: 86vw;
			margin: 2.5vh 7vw 0;
		}
		.payBott>input{
			border:none;
			padding:1vh 0;
			width: 86vw;
			background: #2EB6AA;
			border-radius:0.2rem;
			color: #FFF;
			letter-spacing: 0.1rem;
		}
		/*模态框样式*/
	  .modelAll{width:100vw;height:100vh;font-family: "mircoft yahei";font-size:14px;font-size: 0.7rem;line-height: 1; display: none;}
      .modal{position:absolute;left:0;right:0;z-index: -1;}
      .fade{opacity:0;top:-10%;display:block;-webkit-transition:top 0.3s linear;-o-transition:top 0.3s linear;transition:top 0.3s linear;}
      .fade.in{opacity:1;top:10%;}
      .modal-body{width:80%;margin:5rem auto;background-color: #fff;border-radius:0.5rem;}
      .modal-title{position:relative;height:40px;background-color: #D31145;line-height: 40px;border-bottom:1px solid #ccc;}
      .modal-backup{position:absolute;top:0;left:0;right:0;width:100%;height:100%;background-color: rgba(0, 0, 0, 0.5);z-index: 1000;display:none;}
      .modal-content>p{
      	padding:0.8rem;
      	text-align: center;
      	border-bottom:1px solid #E5E5E5;
      }
      .modal-content>p>a{
      	color:#64A0F2;
      }
      .modal-content>p>input{
      	border:none;
      	background: none;
      	color:#64A0F2;
      }
      .modal-content>p:nth-child(4){
      	border:none;
      }
	</style>
</head>
<body>
	<input type="hidden" value='{{$data}}' id="addressInfo">
	<div id="content">
		<header id="header">
			<div id="hLeft">
				<!-- <p>
					<span>收货人：Yoo</span>
					<span>13612345678</span>
				</p>
				<p>
					<span>收货地址：广州市番禺区大石街道五巷子7号</span>
				</p> -->
			</div>
			<a class="iconfont icon-dayuhao-copy-copy" id="hRight" href="{{:U('Address/index')}}"></a>
		</header>
		<div id="main">
			<!-- <div class="goods">
				<div class="img"><img src="1.jpg" alt="正在加载..."></div>
				<div class="dec">
					<h5>RO膜</h5>
					<p>RO膜能够有效地去除水中钙、镁、 细菌、有机物、无机物、金属离子和 放射性物质等</p>
					<div>
						<span class="price">￥120.00</span>
						<span class="num">X&nbsp;<b>2</b></span>
					</div>
					
				</div>
			</div> -->
		</div>

		<div id="calc">
			<p>邮费：￥<span>8.00</span></p>
			<p>共 <b class="numAll">0</b> 件商品&emsp;合计：<b class="priceAll">0</b></p>
		</div>
		<div class="ynticket">
			<b>开具发票</b>
			<a href="{{:U('Invoice/index')}}">
				<span>不开发票</span>
				<i class="iconfont icon-dayuhao-copy-copy"></i>
			</a>
		</div>
		<!-- <div id="payWay">
			<div id="payMask">
			</div>
			<div id="choosePay">
				<div id="payTitle">
					<p id="closePay">X</p>
					<p>
						<span>付款</span>
						<span>￥200.00</span>
					</p>
				</div>
				<div>选择付款方式</div>
				<div id="localPay">
					<p>
						<label for="gold"><i></i>金币</label>
						<input id="gold" type="checkbox" checked>
					</p>
					<p>
						<label for="silver"><i></i>银币</label>
						<input id="silver" type="checkbox">
					</p>
				</div>
				<div id="othersPay">
					<p>
						<label for="weixin"><i></i>微信支付</label>
						<input id="weixin" type="checkbox">
					</p>
					<p>
						<label for="zhifubao"><i></i>支付宝支付</label>
						<input id="zhifubao" type="checkbox">
					</p>
					<p>
						<label for="yinlian"><i></i>银联</label>
						<input id="yinlian" type="checkbox">
					</p>
				</div>
			</div>
			<div id="payNow">
				<div>立即付款</div>
			</div>			
		</div> -->
		<footer id="footerContain">
			<div>实付金额：<span>240.00</span></div>
			<span id="_pay">付款</span>
		</footer>
		<div class="paystyle">
		<div class="paystyleTop"></div>
		<div class="payContain">
			<div class="paytop clearfix">
				<div class="paytopLeft"><i class="iconfont icon-cuohao"></i></div>
				<div class="paytopRight">
					<h3>付款</h3>
					<p>3620.00</p>
				</div>	
			</div>
			<div class="paymidd">
				<h3>选择支付方式</h3>
				<ul class="clearfix">
					<li index="1"><i class="iconfont icon-jinbi"></i>金币<span class="iconfont icon-xuanze"></span></li>
					<li index="2"><i class="iconfont icon-yingbi"></i>银币<span class="iconfont icon-kuang1"></span></li>
					<li index="3"><i class="iconfont icon-z-weixin"></i>微信支付<span class="iconfont icon-kuang1"></span></li>
					<li index="4"><i class="iconfont icon-zhifubao"></i>支付宝支付<span class="iconfont icon-kuang1"></span></li>
					<li index="5"><i class="iconfont icon-yinhang-yinlian-"></i>银联<span class="iconfont icon-kuang1"></span></li>
				</ul>
			</div>
			<div class="payBott">
				<input class=" start" type="button" value="立即支付">
			</div>
		</div>
	</div>
	
	<!-- 模态框的内容 -->
	<div class="modelAll">
		<!-- <a class="start" href="javascript:;">点击</a> -->
		<div class="modal fade">
			<div class="modal-body">
				<div class="modal-content">
					<p>您咱没有绑定银行卡</p>
					<p><a href="#">去绑定</a></p>
					<p><a href="#">其他支付方式</a></p>
					<p><input class="close" type="submit" value="取消"></p>
				</div>
			</div>
		</div>
		<div class="modal-backup"></div>
	</div>
	</div>
	<script src="__PUBLIC__/Home/js/jweixin-1.2.0.js"></script>
	<script>
		//微信接口
		// wx.config({
		//     debug: false,
		//     appId: '{{$info["appId"]}}',
		//     timestamp: '{{$info["timestamp"]}}',
		//     nonceStr: '{{$info["nonceStr"]}}',
		//     signature: '{{$info["signature"]}}',
		//     jsApiList: [
		//       // 所有要调用的 API 都要加到这个列表中
		//       'chooseWXPay'
		//     ]
		// });
		$(function(){
			//获取从后台传来的订单号
			var dangdanID;	
			if(sessionStorage.getItem('order_id')){
				dangdanID = sessionStorage.getItem('order_id');	
				// console.log(dangdanID);
			}

			// 获取后台传来的默认地址
			var addressInfo;
			if($("#addressInfo").val()){ 
				addressInfo = JSON.parse($("#addressInfo").val());
				console.log(addressInfo);
				if(addressInfo){ 
					var addresssHTML = 
						'<p>'+
							'<span>收货人：'+ addressInfo.name +'</span>'+
							'<span>'+ addressInfo.phone +'</span>'+
						'</p>'+
						'<p>'+
							'<span>收货地址：'+ addressInfo.address +'</span>'+
						'</p>';
					// 将用户收货信息添加到页面上
					$("#hLeft").html(addresssHTML);
				}
			} else{
				$("#hLeft").html('添加新地址');
			}
			$("#main").append('<h3 class="dingdanID">订单编号：'+dangdanID+'</h3>')
			/*
				订单遍历
			 */
			// 从本地sessionStorage中获取订单数据
			var lvxinData, goods_data, shopCar_data;
			if(sessionStorage.getItem("lvxinData")){
				// 从滤芯购买传来
				lvxinData = JSON.parse(sessionStorage.getItem("lvxinData"));
			}
			if(sessionStorage.getItem("goods_data")){
				// 从商品详情传来
				goods_data = JSON.parse(sessionStorage.getItem("goods_data"));
			}
			if(sessionStorage.getItem("shopCar_data")){
				// 购物车传来
				shopCar_data = JSON.parse(sessionStorage.getItem("shopCar_data"));
			}
			console.log('lvxinData： ',lvxinData);
			console.log('goods_data： ',goods_data);
			console.log('shopCar_data： ',shopCar_data);
			var goodsHTML = '';	//存放需要支付的商品信息
			var numAll = 0;		//存放订单的总数量
			var priceAll = 0;	//存放订单的总价格
			// 如果有购买滤芯，从’滤芯购买‘过来
			if(lvxinData){
				// 遍历需要支付的滤芯商品信息
				for(var i=0; i<lvxinData.length;i++){
					goodsHTML += '<div class="goods">'+
						'<div class="img"><img src="'+ lvxinData[i].picturepath +'" alt="正在加载..."></div>'+
						'<div class="dec">'+
							'<h5>'+ lvxinData[i].filtername +'</h5>'+
							'<p>'+ lvxinData[i].desc +'</p>'+
							'<div>'+
								'<span class="price">'+ lvxinData[i].price +'</span>'+
								'<span class="num">X&nbsp;<b>'+ lvxinData[i].num +'</b></span>'+
							'</div>'+
						'</div>'+
					'</div>';
					// 统计数量和价格
					numAll += parseInt(lvxinData[i].num);
					priceAll += parseInt(lvxinData[i].priceAll);
				}
				$("#main").append(goodsHTML);	//滤芯订单的信息
				$(".numAll").text(numAll);		//滤芯订单的总数量
				$(".priceAll").text('￥'+priceAll);	//滤芯订单的总价格
				$("#footerContain>div>span").text('￥'+priceAll);	//滤芯订单的总价格
				$(".paytopRight>p").text('￥'+priceAll);	//滤芯订单的总价格

			}else if(goods_data){	// 如果有商品购买，从商品详情’立即购买‘过来
				// 遍历需要支付的商品信息
				goodsHTML += '<div class="goods">'+
					'<div class="img"><img src="'+ goods_data.goodsDetail.path +'" alt="正在加载..."></div>'+
					'<div class="dec">'+
						'<h5>'+ goods_data.goodsDetail.name +'</h5>'+
						'<p>'+ goods_data.goodsDetail.desc +'</p>'+
						'<div>'+
							'<span class="price">'+ goods_data.goodsDetail.price +'</span>'+
							'<span class="num">X&nbsp;<b>'+ goods_data.num +'</b></span>'+
						'</div>'+
					'</div>'+
				'</div>';
				// 统计数量和价格
				numAll = parseInt(goods_data.num);
				priceAll = parseInt(goods_data.goodsDetail.price);
				//快递费
				$("#calc>p>span").text(goods_data.expressMoney);
				$("#main").append(goodsHTML);	//订单的信息
				$(".numAll").text(numAll);		//订单的总数量
				$(".priceAll").text('￥'+ numAll*priceAll);	//订单的总价格
				$("#footerContain>div>span").text('￥'+numAll*priceAll);	//订单的总价格
				$(".paytopRight>p").text('￥'+numAll*priceAll);	//订单的总价格

			}else if(shopCar_data){	// 如果有商品购买，从购物车’结算‘过来
				for(var i=0; i<shopCar_data.length; i++){
					if(shopCar_data[i]){
						// 遍历需要支付的商品信息
						goodsHTML += '<div class="goods">'+
							'<div class="img"><img src="'+ shopCar_data[i].path +'" alt="正在加载..."></div>'+
							'<div class="dec">'+
								'<h5>'+ shopCar_data[i].name +'</h5>'+
								'<p>'+ shopCar_data[i].desc +'</p>'+
								'<div>'+
									'<span class="price">'+ shopCar_data[i].price +'</span>'+
									'<span class="num">X&nbsp;<b>'+ shopCar_data[i].num +'</b></span>'+
								'</div>'+
							'</div>'+
						'</div>';
					}
					// 统计数量和价格
					numAll += parseInt(shopCar_data[i].num);
					priceAll += parseInt(shopCar_data[i].money);
				}
				//快递费
				// $("#calc>p>span").text(goods_data.expressMoney);
				$("#main").append(goodsHTML);	//订单的信息
				$(".numAll").text(numAll);		//订单的总数量
				$(".priceAll").text('￥'+ priceAll);	//订单的总价格
				$("#footerContain>div>span").text('￥'+priceAll);	//订单的总价格
				$(".paytopRight>p").text('￥'+priceAll);	//订单的总价格
			}
			/*
				发票信息
			 */
			var voiceArr
			if(sessionStorage.getItem("voiceArr")){
				voiceArr = JSON.parse(sessionStorage.getItem("voiceArr"));
				console.log(voiceArr[0].type, voiceArr[0].info)

				if(voiceArr[0].type && voiceArr[0].info && voiceArr[0].voicehead && voiceArr[0].phone){
					$(".ynticket>a>span").text(voiceArr[0].type+' / '+ voiceArr[0].info)
				}
			}
			/******** 订单遍历--结束--	**********/
			/*
				付款过程
			 */
			// 点击付款界面左上角" X "
			$("#closePay").on("click",function(){
				$("#header").css({filter: 'brightness(100%)'});
				$("#main").css({filter: 'brightness(100%)'});
				$("#footer").css({filter: 'brightness(100%)'});

				$("#payWay").animate({bottom: '-100vh'}).css({display: 'none'});
			})

			// 点击付款按钮
			// $("#_pay").on("click",function(){
			// 	$("#header").css({filter: 'brightness(80%)'});
			// 	$("#main").css({filter: 'brightness(80%)'});
			// 	$("#footer").css({filter: 'brightness(80%)'});

			// 	$("#payWay").css({display: 'block'}).animate({bottom: '0vh'});
			// })
			//支付方式
			$('#footerContain').click(function(){
				$('.paystyle').slideDown("slow");
			})
			// 付款方式的单选框
			$('.paymidd>ul>li>span').click(function(){
				$('.paymidd>ul>li>span').removeClass('iconfont icon-xuanze').addClass('iconfont icon-kuang1');
				$(this).removeClass('iconfont icon-kuang1').addClass('iconfont icon-xuanze');
			})
			// 付款方式页面隐藏
			$('.paytop>.paytopLeft>i').click(function(){
				$('.paystyle').slideUp("slow");
			})
			// 模态框的js
			// $(function(){
		 //      	$(".start").on("click",function(){
		 //       	   $(".modal").addClass("in");
		 //       	   $(".modal").css('z-index','1001');
		 //       	   $(".modelAll").css('display','block');
		 //       	   $(".modal-backup").css('display','block');
		 //       });
		 //      	$(".close").on("click",function(){
		 //       	   $(".modal").removeClass('in');
		 //       	   $(".modal").css('z-index','-1');
		 //       	   $(".modal-backup").fadeOut('slow');
		 //       });
	  //     	})
	      	/*
	      		点击立即支付
	      	 */ 
			$(".payBott").click(function(){
				// 判断选择的是什么支付方式
				var index = $(".icon-xuanze").parents("li").attr("index");
				// console.log(index);
				switch(index){
					case '1':
						console.log('金币');
						break;
					case '2':
						console.log('银币');
						break;
					case '3':
						console.log('微信支付');
						//如果有默认地址
						if($("#addressInfo").val()){
							//请求微信支付方法
							$.ajax({
								url: "{{:U('Home/PaymentSystem/orderPay')}}",
								type: 'post',
								data: {order: dangdanID},
								success: function(res){
									console.log(res);
									if(res == -1){
										console.log('支付错误！');
									}else{
										if($("#addressInfo").val()){
											// 调用微信支付方法
											weixinPay(res);
										}else{
											//无地址
											alert('请添加一个地址！')
										}
									}
								},
								error: function(res){
									console.log('失败！ ',res);
								}

							});
						}else{
							alert('请添加一个收获地址！');
						}
						break;
					case '4':
						console.log('支付宝支付');
						break;
					case '5':
						console.log('银联支付');
						break;
					
					default:
						console.log('无');
						break;
				}
			})
	      	/*
	      		微信支付方法
	      	 */ 
	      	function weixinPay(res){
	      		WeixinJSBridge.invoke(
	      			'getBrandWCPayRequest',
	      			JSON.parse(res),
	      			function(res){
	      				if(res.err_msg.substr(-2) == 'ok'){
	      					//付款成功后的操作
	      					location.href = '{{:U("PaymentSystem/paytosuccess")}}';

	      				}else if(res.err_msg.substr(-6) == 'cancel'){
	      					//取消订单操作
	      				}else{
	      					//付款失败操作
	      					location.href = '{{:U("PaymentSystem/paytofailed")}}';
	      				}
	      			}
	      		)
	      	}

			/******** 付款过程--结束--	**********/

		})
		
	</script>
</body>
</html>