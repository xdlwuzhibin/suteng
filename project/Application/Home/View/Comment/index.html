<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0,minimal-ui" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
  	<link rel="stylesheet" href="__PUBLIC__/Home/css/resetstyle.css">
 	<link rel="stylesheet" href="__PUBLIC__/Home/fonts/iconfont.css">
	<title>发表评论</title>
</head>
<style>
	body{
		font-size: 0.7rem;
	}
	/*评论级别*/
	.xuanping{
		width: 90%;
		padding: 1rem 5%;
		border-bottom:10px solid #f3f3f3;

	}
	.xuanping>.pingpic{
		box-sizing: border-box;
		padding:0.1rem;
		width: 25%;
		float: left;
	}
	.xuanping>.pingpic>img{
		width: 100%;
	}
	

	/*商品评价*/
	.shangpingpic{
		width: 90%;
		padding:0.4rem 5%;
		position: relative;
	}
	/*文本域*/
	.shangpingpic>label>textarea{
		color:#5a5a5a;
		font-size: 0.7rem;
	}
	.shangpingpic>label>textarea {
		margin-top: 0.133333rem 0.5rem 0;
		height:5.333333rem;
		width: 100%;
		display: inline-block;
		resize: none;
		overflow: hidden;
		border:none;
		font-size: 0.6rem;
		letter-spacing: 0.05rem;
		line-height: 0.9rem;
	
	}
	.shangping{
		border-bottom:10px solid #f3f3f3;
	}

	/*图片上传*/
	.shangpingpic>span{
		display: block;
		margin-top: 0.5rem;
	}
	.shangpingpic>span>i{
		font-size: 4.5rem;
		color:#68b1f1;
	}
	.shangpingpic>span>em{
		position: absolute;
	    top: 10.98rem;
	    left: 2.2rem;
	    font-size: 0.5rem;
	    color:#5a5a5a;

	}
	.saleBott{
		width: 86%;
		height: 1.8rem;
		margin:0 7%;
		position: fixed;
		bottom: 1rem;
	}
	
	.saleBott input{
		height:1.8rem;
		width: 100%;
		color:#FFF;
		background: #2EB6AA;
		border:0.2rem;
		font-size: 0.82rem;
		letter-spacing: 0.1rem;
		border-radius: 0.2rem;
	}
	.shangpingpic>input {
	    opacity: 0;
	    display: block;
	    width: 4.2rem;
	    height: 4.2rem;
	    position: absolute;
	    bottom: 1rem;
	    left: 0.8rem;
	}
	/*中好差评的样式设置*/
	 .everyItem{
            position: relative;
            line-height: 3rem;
            float: left;
        }
        
      .everyItem>input[type="radio"] {
            width: 2rem;
            height: 2rem;
            opacity: 0;
        }
        
      .everyItem>label {
            position: absolute;
   			left: 1rem;
   			top: 1.3rem;
   			width: 0.8rem;
   			height: 0.8rem;
   			border-radius: 17%;
   			border: 1px solid #999;
        }
       .everyItem>span{
			font-size: 0.68rem;
			color: #5a5a5a;
       }
        
        /*设置选中的input的样式*/
        /* + 是兄弟选择器,获取选中后的label元素*/
      .everyItem>input:checked+label { 
            background-color: #56aaf1;
            border: 1px solid #56aaf1;
            /*color:#56aaf1;*/
        }
        
      .everyItem>input:checked+label::after {
            position: absolute;
   			content: "";
   			width: 0.3rem;
   			height: 0.5rem;
   			top: 0rem;
   			left: 0.2rem;
   			border: 0.1rem solid #fff;
   			border-top: none;
   			border-left: none;
   			transform: rotate(45deg);
        }
        /*显示上传的图片*/
        #picShow {
        	position: absolute;
        	width: 70%;
        	height: 4rem;
        	bottom: 1rem;
        	right: 0;
        	display: block;
        }
        #picShow>span {
        	width: 30%;
        	height: 100%;
        	display: inline-block;
        	position: relative;
        	margin: 0 6px;
        }
        .delPic {
        	position: absolute;
        	width: .8rem;
        	height: .8rem;
        	top: 0;
        	right: 0;
        	display: flex;
        	justify-content: center;
        	align-items: center;
        	color: #fff;
        	border-radius: 50%;
        	background: red;
        }
	
</style>

<body>
	<div class="commentcontain">
		<form id="form" action="commentsucceed" method="post" enctype="multipart/form-data">
			<div class="xuanping clearfix">
				<div class="pingpic"><img src="__PUBLIC__/Home/images/comm_02.png" alt=""></div>
				<!-- 用户ID -->
				<input type="hidden" name="uid" value="11111">
				<!-- 商品ID -->
				<input type="hidden" name="gid" value="22222">
			    <div class='everyItem'>
			        <input id="item1" type="radio" name="status" value="1" checked>
			        <label for="item1"></label>
			        <span>好评</span>
			    </div>
			    <div class='everyItem'>
			        <input id="item2" type="radio" name="status" value="2">
			        <label for="item2"></label>
			        <span>中评</span>
			    </div>
			    <div class='everyItem'>
			        <input id="item3" type="radio" name="status" value="3">
			        <label for="item3"></label>
			        <span>差</span>
			    </div>
			</div>
			<div class="shangping">
				<div class="shangpingpic">
					<label for="shopping">
						<textarea name="content" id="shopping" cols="30" rows="10" placeholder="请您对我们的商品做出评价……"></textarea>
					</label>
					<span><i class="iconfont icon-tianjia"></i><em>限3张内</em></span>
					<input class="file_upload" multiple name="pic[]" type="file" accept="image/gif,image/jpeg,image/jpg,image/png,image/svg">
					<div id="picShow"></div>
				</div>
			</div>
			<a href="{{:U('Home/Comment/commentsucceed')}}">
				<div class="saleBott">
					<input id="submit" type="button" value="提交">
				</div>
			</a>
		</form>
	</div>
	<script src="__PUBLIC__/Home/js/jquery-1.8.3.min.js"></script>
	<script type="text/javascript" src="__PUBLIC__/Admin/layui/layui.js"></script>
	<link rel="stylesheet" href="__PUBLIC__/Admin/layui/css/layui.css" />
	<script src="__PUBLIC__/Home/js/jquery-1.10.1.js"></script>
  	<script src="__PUBLIC__/Home/js/public.js"></script>
	<script>
		//将评论的商品信息显示到页面从我的订单~待评论传来
		if(sessionStorage.getItem("pinglunObj")){
			var pinglunObj = JSON.parse(sessionStorage.getItem("pinglunObj"));
			// console.log(pinglunObj)
			$(".pingpic>img").attr("src",pinglunObj.pic);
		}
		var file = $("#form")[0];// 获取上传文件的input标签	
		var formData = new FormData(file);// 实例化一个formdata对象
		var fileList;// 获取的图片文件
		formData.append("file",file);
		$(".file_upload").on('change',function(e){
			var fileList = e.target.files;
			console.log(fileList)
			$.each(fileList, function(index, item){
				var fileName = item.name;
				formData.append('UploadForm[picture][]',item)
				if(formData.getAll('UploadForm[picture][]').length > 2){
					console.log('3张了');
					$(".file_upload").css({display: 'none'});
				}
				console.log(formData.getAll('UploadForm[picture][]'));
			})
			//图片显示
			var files =this.files;
			var span = $("<span></span>"),
				span1 = $("<span>X</span>"),
				img = $('<img src="" alt="" />'
					);
			var reader =new FileReader();
			reader.readAsDataURL(files[0]);
			reader.onload =function(e){
				
				var dx =(e.total/1024)/1024;
				if(dx>=2){
				  alert("文件大小大于2M");
				  return;
				}
				img[0].src = this.result;
				img[0].width = "100%";
				img[0].height = "90%";
				
				// console.log(span, span[0]);
				span1.addClass("delPic");
				span1.css({zIndex: '999'});
				span.append(span1);
				span.append(img[0]);
				$('#picShow').append(span);
			}
		})
		$("#submit").click(function(){
			if($("#shopping").val()==""){
				layuiHint("请您对我们的商品做出评价呗");
				return false;
			}
		});
	</script>
</body>
</html>